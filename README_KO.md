<div align="center">
<h1>HivisionIDPhoto</h1>

[English](README_EN.md) / [ä¸­æ–‡](README_CN.md) / [æ—¥æœ¬èª](README_JP.md) / í•œêµ­ì–´

[![GitHub](https://img.shields.io/static/v1?label=GitHub&message=GitHub&color=black)](https://github.com/xiaolin199912/HivisionIDPhotos)
[![SwanHub Demo](https://swanhub.co/git/repo/SwanHub%2FAuto-README/file/preview?ref=main&path=swanhub.svg)](https://swanhub.co/ZeYiLin/HivisionIDPhotos/demo)
[![zhihu](https://img.shields.io/static/v1?label=çŸ¥ä¹&message=çŸ¥ä¹&color=blue)](https://zhuanlan.zhihu.com/p/638254028)
[![Spaces](https://img.shields.io/badge/ğŸ¤—-Open%20in%20Spaces-blue)](https://huggingface.co/spaces/TheEeeeLin/HivisionIDPhotos)

<a href="https://trendshift.io/repositories/11622" target="_blank"><img src="https://trendshift.io/api/badge/repositories/11622" alt="Zeyi-Lin%2FHivisionIDPhotos | Trendshift" style="width: 250px; height: 55px;" width="250" height="55"/></a>

<img src="assets/demoImage.png" width=900>
</div>

<br>

> **ê´€ë ¨ í”„ë¡œì íŠ¸**ï¼š
>
> - [SwanLab](https://github.com/SwanHubX/SwanLab)ï¼šì¸ë¬¼ ì‚¬ì§„ ëª¨ë¸ì˜ í•™ìŠµì„ ë¶„ì„ ë° ëª¨ë‹ˆí„°ë§í•˜ê³  ì‹¤í—˜ì‹¤ ë™ë£Œì™€ í˜‘ì—…í•˜ì—¬ í•™ìŠµ íš¨ìœ¨ì„±ì„ í¬ê²Œ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•´ ì‚¬ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.

<br>

# ğŸ¤© í”„ë¡œì íŠ¸ ì—…ë°ì´íŠ¸

- ì˜¨ë¼ì¸ ì²´í—˜: [![SwanHub Demo](https://img.shields.io/static/v1?label=Demo&message=SwanHub%20Demo&color=blue)](https://swanhub.co/ZeYiLin/HivisionIDPhotos/demo)ã€[![Spaces](https://img.shields.io/badge/ğŸ¤—-Open%20in%20Spaces-blue)](https://huggingface.co/spaces/TheEeeeLin/HivisionIDPhotos)
- 2024.9.2: **ì‚¬ì§„ KB í¬ê¸° ì¡°ì •** ì—…ë°ì´íŠ¸
- 2023.12.1: **API ë°°í¬(fastapi ê¸°ë°˜)** ì—…ë°ì´íŠ¸
- 2023.6.20: **ë¯¸ë¦¬ ì„¤ì •ëœ ì‚¬ì´ì¦ˆ ë©”ë‰´** ì—…ë°ì´íŠ¸
- 2023.6.19: **ë ˆì´ì•„ì›ƒ ì‚¬ì§„** ì—…ë°ì´íŠ¸
- 2023.6.13: **ì¤‘ì•™ ê·¸ë¼ë°ì´ì…˜ ìƒ‰ìƒ** ì—…ë°ì´íŠ¸
- 2023.6.11: **ìƒí•˜ ê·¸ë¼ë°ì´ì…˜ ìƒ‰ìƒ** ì—…ë°ì´íŠ¸
- 2023.6.8: **ë§ì¶¤í˜• ì‚¬ì´ì¦ˆ** ì—…ë°ì´íŠ¸
- 2023.6.4: **ë§ì¶¤í˜• ë°°ê²½ìƒ‰, ì–¼êµ´ ì¸ì‹ ì˜¤ë¥˜ ì•Œë¦¼** ì—…ë°ì´íŠ¸
- 2023.5.10: **í¬ê¸° ë³€ê²½ ì—†ì´ ë°°ê²½ë§Œ êµì²´** ì—…ë°ì´íŠ¸

# ê°œìš”

> ğŸš€ ì €í¬ ì‘ì—…ì— ê´€ì‹¬ì„ ê°€ì ¸ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ì´ë¯¸ì§€ ë¶„ì•¼ì˜ ë‹¤ë¥¸ ì„±ê³¼ë„ í™•ì¸í•´ë³´ì‹œê¸° ë°”ëë‹ˆë‹¤. ë¬¸ì˜ì‚¬í•­ì€ ì´ë©”ì¼ë¡œ ì—°ë½ì£¼ì„¸ìš”: zeyi.lin@swanhub.co.

HivisionIDPhotoëŠ” ì‹¤ìš©ì ì¸ ì¦ëª…ì‚¬ì§„ ìë™ ìƒì„± ì•Œê³ ë¦¬ì¦˜ì„ ê°œë°œí•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.

ì´ í”„ë¡œì íŠ¸ëŠ” ë‹¤ì–‘í•œ ì‚¬ìš©ì ì´¬ì˜ ì¥ë©´ì„ ì¸ì‹í•˜ê³ , ì¸ë¬¼ ì‚¬ì§„ì„ ë°°ê²½ì—ì„œ ë¶„ë¦¬í•˜ì—¬ ì¦ëª…ì‚¬ì§„ì„ ìƒì„±í•  ìˆ˜ ìˆëŠ” í¬ê´„ì ì¸ ëª¨ë¸ ì›Œí¬í”Œë¡œìš°ë¥¼ í™œìš©í•©ë‹ˆë‹¤.

**HivisionIDPhotoëŠ” ë‹¤ìŒì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:**

1. ê²½ëŸ‰í™”ëœ ë°°ê²½ ì œê±° (CPUë§Œìœ¼ë¡œë„ ë¹ ë¥´ê²Œ ì¶”ë¡  ê°€ëŠ¥)
2. ë‹¤ì–‘í•œ í¬ê¸° ê·œê²©ì— ë”°ë¼ í‘œì¤€ ì¦ëª…ì‚¬ì§„ ë° ì—¬ì„¯ ì»· ë ˆì´ì•„ì›ƒ ì‚¬ì§„ ìƒì„±
3. ë¯¸í™”(ì¶”í›„ ì§€ì› ì˜ˆì •)
4. ì§€ëŠ¥í˜• ì •ì¥ ë³€ê²½(ì¶”í›„ ì§€ì› ì˜ˆì •)

<div align="center">
<img src="assets/gradio-image.jpeg" width=900>
</div>

---

HivisionIDPhotoê°€ ìœ ìš©í•˜ì…¨ë‹¤ë©´, ì´ ì €ì¥ì†Œì— ë³„ì„ ë‹¬ê±°ë‚˜ ì¹œêµ¬ë“¤ì—ê²Œ ì¶”ì²œí•˜ì—¬ ì¦ëª…ì‚¬ì§„ ì‘ê¸‰ ì œì‘ ë¬¸ì œë¥¼ í•´ê²°í•´ë³´ì„¸ìš”!

<br>

# ğŸ”§ í™˜ê²½ ì„¤ì¹˜ ë° ì˜ì¡´ì„±

- Python >= 3.7 (í”„ë¡œì íŠ¸ëŠ” ì£¼ë¡œ Python 3.10ì—ì„œ í…ŒìŠ¤íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤)
- onnxruntime
- OpenCV
- ì„ íƒ ì‚¬í•­: Linux, Windows, MacOS

**1. í”„ë¡œì íŠ¸ í´ë¡ **

```bash
git clone https://github.com/Zeyi-Lin/HivisionIDPhotos.git
cd  HivisionIDPhotos
```

**2. ì˜ì¡´ì„± ì„¤ì¹˜**

```bash
pip install -r requirements.txt
```

**3. ëª¨ë¸ ê°€ì¤‘ì¹˜ ë‹¤ìš´ë¡œë“œ**

[Release](https://github.com/Zeyi-Lin/HivisionIDPhotos/releases/tag/pretrained-model)ì—ì„œ ê°€ì¤‘ì¹˜ íŒŒì¼ `hivision_modnet.onnx`ë¥¼ ë‹¤ìš´ë¡œë“œí•˜ì—¬ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— ì €ì¥í•˜ì„¸ìš”.

<br>

# ğŸš€ Gradio ë°ëª¨ ì‹¤í–‰

```bash
python app.py
```

í”„ë¡œê·¸ë¨ì„ ì‹¤í–‰í•˜ë©´ ë¡œì»¬ ì›¹ í˜ì´ì§€ê°€ ìƒì„±ë˜ë©°, í•´ë‹¹ í˜ì´ì§€ì—ì„œ ì¦ëª…ì‚¬ì§„ ì‘ì—… ë° ìƒí˜¸ì‘ìš©ì„ ì™„ë£Œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<br>

# âš¡ï¸ API ì„œë¹„ìŠ¤ ë°°í¬

```
python deploy_api.py
```

**API ì„œë¹„ìŠ¤ ìš”ì²­(Python)**

Pythonì„ ì‚¬ìš©í•˜ì—¬ ì„œë¹„ìŠ¤ì— ìš”ì²­ì„ ë³´ë‚¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤:

ì¦ëª…ì‚¬ì§„ ìƒì„±(ì‚¬ì§„ 1ì¥ì„ ì…ë ¥í•˜ì—¬ í‘œì¤€ ì¦ëª…ì‚¬ì§„ 1ì¥ê³¼ ê³ í•´ìƒë„ ì¦ëª…ì‚¬ì§„ì˜ 4ì±„ë„ íˆ¬ëª… PNG 1ì¥ì„ ì–»ìŠµë‹ˆë‹¤):

```bash
python requests_api.py -u http://127.0.0.1:8080 -i images/test.jpg -o ./idphoto.png -s '(413,295)'
```

ë°°ê²½ìƒ‰ ì¶”ê°€(4ì±„ë„ íˆ¬ëª… PNG 1ì¥ì„ ì…ë ¥í•˜ì—¬ ë°°ê²½ìƒ‰ì´ ì¶”ê°€ëœ ì´ë¯¸ì§€ë¥¼ ì–»ìŠµë‹ˆë‹¤):

```bash
python requests_api.py -u http://127.0.0.1:8080 -t add_background -i ./idphoto.png -o ./idhoto_ab.jpg  -c '(0,0,0)' -k 30
```

ì—¬ì„¯ ì»· ë ˆì´ì•„ì›ƒ ì‚¬ì§„ ì–»ê¸°(3ì±„ë„ ì‚¬ì§„ 1ì¥ì„ ì…ë ¥í•˜ì—¬ ì—¬ì„¯ ì»· ë ˆì´ì•„ì›ƒ ì‚¬ì§„ì„ ì–»ìŠµë‹ˆë‹¤):

```bash
python requests_api.py -u http://127.0.0.1:8080 -t generate_layout_photos -i ./idhoto_ab.jpg -o ./idhoto_layout.jpg  -s '(413,295)' -k 200
```

<br>

# ğŸ³ Docker ë°°í¬

## 1. ì´ë¯¸ì§€ ê°€ì ¸ì˜¤ê¸° ë˜ëŠ” ë¹Œë“œ

> ë‹¤ìŒ 3ê°€ì§€ ë°©ë²• ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•˜ì‹­ì‹œì˜¤.

**ì´ë¯¸ì§€ ê°€ì ¸ì˜¤ê¸°:**

> ì´ ì´ë¯¸ì§€ëŠ” ARM ì•„í‚¤í…ì²˜ ë¨¸ì‹ (Mac M1 ë“±)ì—ì„œ ë¹Œë“œë˜ì—ˆìŠµë‹ˆë‹¤. x86 ì•„í‚¤í…ì²˜ ë¨¸ì‹ ì—ì„œ ì‚¬ìš©í•  ê²½ìš° Dockerfileì„ ì‚¬ìš©í•˜ì—¬ ë¹Œë“œí•˜ì„¸ìš”.

```bash
docker pull linzeyi/hivision_idphotos:v1
```

**Dockerfileë¡œ ì´ë¯¸ì§€ ë¹Œë“œ:**

ëª¨ë¸ ê°€ì¤‘ì¹˜ íŒŒì¼ [hivision_modnet.onnx](https://github.com/Zeyi-Lin/HivisionIDPhotos/releases/tag/pretrained-model)ì„ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì— ë†“ê³ , ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì—ì„œ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì„¸ìš”:

```bash
docker build -t hivision_idphotos .
```

**Docker Compose:**

ëª¨ë¸ ê°€ì¤‘ì¹˜ íŒŒì¼ [hivision_modnet.onnx](https://github.com/Zeyi-Lin/HivisionIDPhotos/releases/tag/pretrained-model)ê°€ ë£¨íŠ¸ ë””ë ‰í„°ë¦¬ì— ìˆëŠ”ì§€ í™•ì¸í•œ í›„ ë£¨íŠ¸ ë””ë ‰í„°ë¦¬ì—ì„œ ì‹¤í–‰í•©ë‹ˆë‹¤:

```bash
ë„ì»¤ ì»´í¬ì¦ˆ ë¹Œë“œ
```

ì´ë¯¸ì§€ íŒ¨í‚¤ì§•ì´ ì™„ë£Œë˜ë©´ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ API ì„œë¹„ìŠ¤ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤:

```bash
docker compose up -d
```

## 2. Gradio ë°ëª¨ ì‹¤í–‰

ì´ë¯¸ì§€ íŒ¨í‚¤ì§•ì´ ì™„ë£Œë˜ë©´ ë‹¤ìŒ ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ì—¬ Gradio ë°ëª¨ ì„œë¹„ìŠ¤ë¥¼ ì‹œì‘í•˜ì„¸ìš”:

```bash
docker run -p 7860:7860 hivision_idphotos
```

ë¡œì»¬ì—ì„œ [http://127.0.0.1:7860](http://127.0.0.1:7860/)ì— ì ‘ì†í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## 3. API ë°±ì—”ë“œ ì„œë¹„ìŠ¤ ì‹¤í–‰

```bash
docker run -p 8080:8080 hivision_idphotos python3 deploy_api.py
```

<br>

# ğŸ“– í”„ë¡œì íŠ¸ ì¸ìš©

1. MTCNN:

```bibtex
@software{ipazc_mtcnn_2021,
    author = {ipazc},
    title = {{MTCNN}},
    url = {https://github.com/ipazc/mtcnn},
    year = {2021},
    publisher = {GitHub}
}
```

2. ModNet:

```bibtex
@software{zhkkke_modnet_2021,
    author = {ZHKKKe},
    title = {{ModNet}},
    url = {https://github.com/ZHKKKe/MODNet},
    year = {2021},
    publisher = {GitHub}
}
```

<br>

# ğŸ’» ê°œë°œ íŒ

**1. ë¯¸ë¦¬ ì„¤ì •ëœ ì‚¬ì´ì¦ˆë¥¼ ì–´ë–»ê²Œ ìˆ˜ì •í•˜ë‚˜ìš”?**

[size_list_CN.csv](size_list_CN.csv)ì„ ìˆ˜ì •í•œ í›„ app.py ë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•˜ì„¸ìš”. ì²« ë²ˆì§¸ ì—´ì€ ì‚¬ì´ì¦ˆ ì´ë¦„, ë‘ ë²ˆì§¸ ì—´ì€ ë†’ì´, ì„¸ ë²ˆì§¸ ì—´ì€ ë„ˆë¹„ì…ë‹ˆë‹¤.

<br>

# ğŸ“§ ë¬¸ì˜í•˜ê¸°

ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ zeyi.lin@swanhub.co ë¡œ ì´ë©”ì¼ì„ ë³´ë‚´ì£¼ì„¸ìš”.

<br>

# ê¸°ì—¬ì

[Zeyi-Lin](https://github.com/Zeyi-Lin)ã€[SAKURA-CAT](https://github.com/SAKURA-CAT)ã€[Feudalman](https://github.com/Feudalman)ã€[swpfY](https://github.com/swpfY)ã€[Kaikaikaifang](https://github.com/Kaikaikaifang)ã€[ShaohonChen](https://github.com/ShaohonChen)ã€[KashiwaByte](https://github.com/KashiwaByte)

<br>

# StarHistory

[![Star History Chart](https://api.star-history.com/svg?repos=Zeyi-Lin/HivisionIDPhotos&type=Date)](https://star-history.com/#Zeyi-Lin/HivisionIDPhotos&Date)
