<div align="center">
<h1>HivisionIDPhoto</h1>

[English](README_EN.md) / [ä¸­æ–‡](README_CN.md) / [æ—¥æœ¬èª](README_JP.md) / í•œêµ­ì–´

[![GitHub](https://img.shields.io/static/v1?label=GitHub&message=GitHub&color=black)](https://github.com/xiaolin199912/HivisionIDPhotos)
[![SwanHub Demo](https://swanhub.co/git/repo/SwanHub%2FAuto-README/file/preview?ref=main&path=swanhub.svg)](https://swanhub.co/ZeYiLin/HivisionIDPhotos/demo)
[![zhihu](https://img.shields.io/static/v1?label=çŸ¥ä¹&message=çŸ¥ä¹&color=blue)](https://zhuanlan.zhihu.com/p/638254028)
[![Spaces](https://img.shields.io/badge/ğŸ¤—-Open%20in%20Spaces-blue)](https://huggingface.co/spaces/TheEeeeLin/HivisionIDPhotos)

<a href="https://trendshift.io/repositories/11622" target="_blank"><img src="https://trendshift.io/api/badge/repositories/11622" alt="Zeyi-Lin%2FHivisionIDPhotos | Trendshift" style="width: 250px; height: 55px;" width="250" height="55"/></a>

<img src="assets/demoImage.png" width=900>
</div>

<br>

> **ê´€ë ¨ í”„ë¡œì íŠ¸**ï¼š
>
> - [SwanLab](https://github.com/SwanHubX/SwanLab)ï¼šì¸ë¬¼ ì‚¬ì§„ ëª¨ë¸ì˜ í•™ìŠµì„ ë¶„ì„ ë° ëª¨ë‹ˆí„°ë§í•˜ê³  ì‹¤í—˜ì‹¤ ë™ë£Œì™€ í˜‘ì—…í•˜ì—¬ í•™ìŠµ íš¨ìœ¨ì„±ì„ í¬ê²Œ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•´ ì‚¬ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.

<br>

# ğŸ¤© í”„ë¡œì íŠ¸ ì—…ë°ì´íŠ¸

- ì˜¨ë¼ì¸ ì²´í—˜: [![SwanHub Demo](https://img.shields.io/static/v1?label=Demo&message=SwanHub%20Demo&color=blue)](https://swanhub.co/ZeYiLin/HivisionIDPhotos/demo)ã€[![Spaces](https://img.shields.io/badge/ğŸ¤—-Open%20in%20Spaces-blue)](https://huggingface.co/spaces/TheEeeeLin/HivisionIDPhotos)
- 2024.9.2: **ì‚¬ì§„ KB í¬ê¸° ì¡°ì •** ì—…ë°ì´íŠ¸ï¼Œ[DockerHub](https://hub.docker.com/r/linzeyi/hivision_idphotos/tags)
- 2023.12.1: **API ë°°í¬(fastapi ê¸°ë°˜)** ì—…ë°ì´íŠ¸
- 2023.6.20: **ë¯¸ë¦¬ ì„¤ì •ëœ ì‚¬ì´ì¦ˆ ë©”ë‰´** ì—…ë°ì´íŠ¸
- 2023.6.19: **ë ˆì´ì•„ì›ƒ ì‚¬ì§„** ì—…ë°ì´íŠ¸

# ê°œìš”

> ğŸš€ ì €í¬ ì‘ì—…ì— ê´€ì‹¬ì„ ê°€ì ¸ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤. ì´ë¯¸ì§€ ë¶„ì•¼ì˜ ë‹¤ë¥¸ ì„±ê³¼ë„ í™•ì¸í•´ë³´ì‹œê¸° ë°”ëë‹ˆë‹¤. ë¬¸ì˜ì‚¬í•­ì€ ì´ë©”ì¼ë¡œ ì—°ë½ì£¼ì„¸ìš”: zeyi.lin@swanhub.co.

HivisionIDPhotoëŠ” ì‹¤ìš©ì ì¸ ì¦ëª…ì‚¬ì§„ ìë™ ìƒì„± ì•Œê³ ë¦¬ì¦˜ì„ ê°œë°œí•˜ëŠ” ê²ƒì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.

ì´ í”„ë¡œì íŠ¸ëŠ” ë‹¤ì–‘í•œ ì‚¬ìš©ì ì´¬ì˜ ì¥ë©´ì„ ì¸ì‹í•˜ê³ , ì¸ë¬¼ ì‚¬ì§„ì„ ë°°ê²½ì—ì„œ ë¶„ë¦¬í•˜ì—¬ ì¦ëª…ì‚¬ì§„ì„ ìƒì„±í•  ìˆ˜ ìˆëŠ” í¬ê´„ì ì¸ ëª¨ë¸ ì›Œí¬í”Œë¡œìš°ë¥¼ í™œìš©í•©ë‹ˆë‹¤.

**HivisionIDPhotoëŠ” ë‹¤ìŒì„ ìˆ˜í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤:**

1. ê²½ëŸ‰í™”ëœ ë°°ê²½ ì œê±° (CPUë§Œìœ¼ë¡œë„ ë¹ ë¥´ê²Œ ì¶”ë¡  ê°€ëŠ¥)
2. ë‹¤ì–‘í•œ í¬ê¸° ê·œê²©ì— ë”°ë¼ í‘œì¤€ ì¦ëª…ì‚¬ì§„ ë° ì—¬ì„¯ ì»· ë ˆì´ì•„ì›ƒ ì‚¬ì§„ ìƒì„±
3. ë¯¸í™”(ì¶”í›„ ì§€ì› ì˜ˆì •)
4. ì§€ëŠ¥í˜• ì •ì¥ ë³€ê²½(ì¶”í›„ ì§€ì› ì˜ˆì •)

<div align="center">
<img src="assets/gradio-image.jpeg" width=900>
</div>

---

HivisionIDPhotoê°€ ìœ ìš©í•˜ì…¨ë‹¤ë©´, ì´ ì €ì¥ì†Œì— ë³„ì„ ë‹¬ê±°ë‚˜ ì¹œêµ¬ë“¤ì—ê²Œ ì¶”ì²œí•˜ì—¬ ì¦ëª…ì‚¬ì§„ ì‘ê¸‰ ì œì‘ ë¬¸ì œë¥¼ í•´ê²°í•´ë³´ì„¸ìš”!

<br>

# ğŸ”§ í™˜ê²½ ì„¤ì¹˜ ë° ì˜ì¡´ì„±

- Python >= 3.7 (í”„ë¡œì íŠ¸ëŠ” ì£¼ë¡œ Python 3.10ì—ì„œ í…ŒìŠ¤íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤)
- onnxruntime
- OpenCV
- ì„ íƒ ì‚¬í•­: Linux, Windows, MacOS

**1. í”„ë¡œì íŠ¸ í´ë¡ **

```bash
git clone https://github.com/Zeyi-Lin/HivisionIDPhotos.git
cd  HivisionIDPhotos
```

**2. (ì¤‘ìš”í•¨) ì˜ì¡´ì„± ì„¤ì¹˜**

> condaë¥¼ ì‚¬ìš©í•˜ì—¬ Python 3.10 ê°€ìƒ í™˜ê²½ì„ ë§Œë“  ë‹¤ìŒ ë‹¤ìŒ ëª…ë ¹ì„ ì‹¤í–‰í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

```bash
pip install -r requirements.txt
pip install -r requirements-app.txt
```

**3. ëª¨ë¸ ê°€ì¤‘ì¹˜ ë‹¤ìš´ë¡œë“œ**

[Release](https://github.com/Zeyi-Lin/HivisionIDPhotos/releases/tag/pretrained-model)ì—ì„œ ë¬´ê²Œ íŒŒì¼ 'hivision_modnet.onnx' (24.7MB)ì„ ë‹¤ìš´ë¡œë“œí•˜ì—¬ í”„ë¡œì íŠ¸ì˜ 'hivision/creator/weights' ë””ë ‰í† ë¦¬ì— ì €ì¥í•˜ì‹­ì‹œì˜¤.

<br>

# ğŸš€ Python ì¶”ë¡ 

## 1. ì‹ ë¶„ì¦ ì‚¬ì§„ ì œì‘

1ì¥ì˜ ì‚¬ì§„ì„ ì…ë ¥í•˜ì—¬ 1ì¥ì˜ í‘œì¤€ ì‹ ë¶„ì¦ ì‚¬ì§„ê³¼ 1ì¥ì˜ ê³ í™”ì§ˆ ì‹ ë¶„ì¦ ì‚¬ì§„ì˜ 4ì±„ë„ íˆ¬ëª… PNGë¥¼ ì–»ìŠµë‹ˆë‹¤.

```python
python inference.py -i demo/images/test.jpg -o ./idphoto.png --height 413 --width 295
```

## 2. ë°°ê²½ìƒ‰ ì¶”ê°€

1ì¥ì˜ 4ì±„ë„ íˆ¬ëª… PNGë¥¼ ì…ë ¥í•˜ì—¬ ë°°ê²½ìƒ‰ì´ ì¶”ê°€ëœ 1ì¥ì˜ ì´ë¯¸ì§€ë¥¼ ì–»ìŠµë‹ˆë‹¤.

```python
python inference.py -t add_background -i ./idphoto.png -o ./idhoto_ab.jpg  -c 000000 -k 30
```

## 3. 6ì¸ì¹˜ ë ˆì´ì•„ì›ƒ ì‚¬ì§„ ì–»ê¸°

1ì¥ì˜ 3ì±„ë„ ì‚¬ì§„ì„ ì…ë ¥í•˜ì—¬ 1ì¥ì˜ 6ì¸ì¹˜ ë ˆì´ì•„ì›ƒ ì‚¬ì§„ì„ ì–»ìŠµë‹ˆë‹¤.

```python
python inference.py -t generate_layout_photos -i ./idhoto_ab.jpg -o ./idhoto_layout.jpg  --height 413 --width 295 -k 200
```

<br>

## API ì„œë¹„ìŠ¤ ìš”ì²­ - Python Request

### 1. ì‹ ë¶„ì¦ ì‚¬ì§„ ì œì‘

1ì¥ì˜ ì‚¬ì§„ì„ ì…ë ¥í•˜ì—¬ 1ì¥ì˜ í‘œì¤€ ì‹ ë¶„ì¦ ì‚¬ì§„ê³¼ 1ì¥ì˜ ê³ í™”ì§ˆ ì‹ ë¶„ì¦ ì‚¬ì§„ì˜ 4ì±„ë„ íˆ¬ëª… PNGë¥¼ ì–»ìŠµë‹ˆë‹¤.

```bash
import requests

url = "http://127.0.0.1:8080/idphoto"
input_image_path = "demo/images/test.jpg"

files = {"input_image": open(input_image_path, "rb")}
data = {"height": 413, "width": 295}

response = requests.post(url, files=files, data=data).json()

# responseëŠ” status, image_base64_standard, image_base64_hdë¥¼ í¬í•¨í•œ JSON í˜•ì‹ì˜ ë”•ì…”ë„ˆë¦¬ì…ë‹ˆë‹¤.
print(response)

```

### 2. ë°°ê²½ìƒ‰ ì¶”ê°€

1ì¥ì˜ 4ì±„ë„ íˆ¬ëª… PNGë¥¼ ì…ë ¥í•˜ì—¬ ë°°ê²½ìƒ‰ì´ ì¶”ê°€ëœ 1ì¥ì˜ ì´ë¯¸ì§€ë¥¼ ì–»ìŠµë‹ˆë‹¤.

```bash
import requests

url = "http://127.0.0.1:8080/add_background"
input_image_path = "test.png"

files = {"input_image": open(input_image_path, "rb")}
data = {"color": '638cce', 'kb': None}

response = requests.post(url, files=files, data=data).json()

# responseëŠ” statusì™€ image_base64ë¥¼ í¬í•¨í•œ JSON í˜•ì‹ì˜ ë”•ì…”ë„ˆë¦¬ì…ë‹ˆë‹¤.
print(response)
```

### 3. 6ì¸ì¹˜ ë ˆì´ì•„ì›ƒ ì‚¬ì§„ ì–»ê¸°

1ì¥ì˜ 3ì±„ë„ ì‚¬ì§„ì„ ì…ë ¥í•˜ì—¬ 1ì¥ì˜ 6ì¸ì¹˜ ë ˆì´ì•„ì›ƒ ì‚¬ì§„ì„ ì–»ìŠµë‹ˆë‹¤.

```bash
import requests

url = "http://127.0.0.1:8080/generate_layout_photos"
input_image_path = "test.jpg"

files = {"input_image": open(input_image_path, "rb")}
data = {"height": 413, "width": 295, "kb": 200}

response = requests.post(url, files=files, data=data).json()

# responseëŠ” statusì™€ image_base64ë¥¼ í¬í•¨í•œ JSON í˜•ì‹ì˜ ë”•ì…”ë„ˆë¦¬ì…ë‹ˆë‹¤.
print(response)
```

ë” ë§ì€ ìš”ì²­ ë°©ë²•ì€ [API ë¬¸ì„œ](docs/api_EN.md)ë¥¼ ì°¸ì¡°í•˜ì„¸ìš”. Python ìŠ¤í¬ë¦½íŠ¸ ìš”ì²­, Python Request ìš”ì²­, Java ìš”ì²­ì´ í¬í•¨ë˜ì–´ ìˆìŠµë‹ˆë‹¤.

<br>

# ğŸ³ Docker ë°°í¬

## 1. ì´ë¯¸ì§€ ê°€ì ¸ì˜¤ê¸° ë˜ëŠ” ë¹Œë“œ

> ë‹¤ìŒ ë°©ë²• ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•˜ì„¸ìš”

**ë°©ë²• 1: ì´ë¯¸ì§€ ê°€ì ¸ì˜¤ê¸°:**

```bash
docker pull linzeyi/hivision_idphotos:v1
docker tag linzeyi/hivision_idphotos:v1 hivision_idphotos
```

**ë°©ë²• 2: Dockerfileë¡œ ì§ì ‘ ì´ë¯¸ì§€ ë¹Œë“œ:**

ëª¨ë¸ ê°€ì¤‘ì¹˜ íŒŒì¼ [hivision_modnet.onnx](https://github.com/Zeyi-Lin/HivisionIDPhotos/releases/tag/pretrained-model)ì„ `hivision/creator/weights` ë””ë ‰í† ë¦¬ì— ë„£ì€ í›„, í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì—ì„œ ë‹¤ìŒì„ ì‹¤í–‰í•©ë‹ˆë‹¤:

```bash
docker build -t hivision_idphotos .
```

**ë°©ë²• 3: Docker composeë¡œ ë¹Œë“œ:**

ëª¨ë¸ ê°€ì¤‘ì¹˜ íŒŒì¼ [hivision_modnet.onnx](https://github.com/Zeyi-Lin/HivisionIDPhotos/releases/tag/pretrained-model)ì„ `hivision/creator/weights` ë””ë ‰í† ë¦¬ì— ë„£ì€ í›„, í”„ë¡œì íŠ¸ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ì—ì„œ ë‹¤ìŒì„ ì‹¤í–‰í•©ë‹ˆë‹¤:

```bash
docker compose build
```

ì´ë¯¸ì§€ íŒ¨í‚¤ì§•ì´ ì™„ë£Œë˜ë©´, ë‹¤ìŒ ëª…ë ¹ì„ ì‹¤í–‰í•˜ì—¬ Gradio ì„œë¹„ìŠ¤ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤:

```bash
docker compose up -d
```

## 2. Gradio Demo ì‹¤í–‰

ì´ë¯¸ì§€ íŒ¨í‚¤ì§•ì´ ì™„ë£Œë˜ë©´, ë‹¤ìŒ ëª…ë ¹ì„ ì‹¤í–‰í•˜ì—¬ Gradio Demo ì„œë¹„ìŠ¤ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤:

```bash
docker run -p 7860:7860 hivision_idphotos
```

ë¡œì»¬ì—ì„œ [http://127.0.0.1:7860](http://127.0.0.1:7860/)ì— ì ‘ì†í•˜ì—¬ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

## 3. API ë°±ì—”ë“œ ì„œë¹„ìŠ¤ ì‹¤í–‰

```bash
docker run -p 8080:8080 hivision_idphotos python3 deploy_api.py
```

<br>


# ğŸ“– í”„ë¡œì íŠ¸ ì¸ìš©

1. MTCNN:

```bibtex
@software{ipazc_mtcnn_2021,
    author = {ipazc},
    title = {{MTCNN}},
    url = {https://github.com/ipazc/mtcnn},
    year = {2021},
    publisher = {GitHub}
}
```

2. ModNet:

```bibtex
@software{zhkkke_modnet_2021,
    author = {ZHKKKe},
    title = {{ModNet}},
    url = {https://github.com/ZHKKKe/MODNet},
    year = {2021},
    publisher = {GitHub}
}
```

<br>

# ğŸ’» ê°œë°œ íŒ

**1. ë¯¸ë¦¬ ì„¤ì •ëœ ì‚¬ì´ì¦ˆë¥¼ ì–´ë–»ê²Œ ìˆ˜ì •í•˜ë‚˜ìš”?**

[size_list_CN.csv](demo/size_list_CN.csv)ì„ ìˆ˜ì •í•œ í›„ app.py ë¥¼ ë‹¤ì‹œ ì‹¤í–‰í•˜ì„¸ìš”. ì²« ë²ˆì§¸ ì—´ì€ ì‚¬ì´ì¦ˆ ì´ë¦„, ë‘ ë²ˆì§¸ ì—´ì€ ë†’ì´, ì„¸ ë²ˆì§¸ ì—´ì€ ë„ˆë¹„ì…ë‹ˆë‹¤.

<br>

# ğŸ“§ ë¬¸ì˜í•˜ê¸°

ë¬¸ì˜ì‚¬í•­ì´ ìˆìœ¼ì‹œë©´ zeyi.lin@swanhub.co ë¡œ ì´ë©”ì¼ì„ ë³´ë‚´ì£¼ì„¸ìš”.

<br>

# ê¸°ì—¬ì

<a href="https://github.com/Zeyi-Lin/HivisionIDPhotos/graphs/contributors">
  <img src="https://contrib.rocks/image?repo=Zeyi-Lin/HivisionIDPhotos" />
</a>

[Zeyi-Lin](https://github.com/Zeyi-Lin)ã€[SAKURA-CAT](https://github.com/SAKURA-CAT)ã€[Feudalman](https://github.com/Feudalman)ã€[swpfY](https://github.com/swpfY)ã€[Kaikaikaifang](https://github.com/Kaikaikaifang)ã€[ShaohonChen](https://github.com/ShaohonChen)ã€[KashiwaByte](https://github.com/KashiwaByte)

<br>

# StarHistory

[![Star History Chart](https://api.star-history.com/svg?repos=Zeyi-Lin/HivisionIDPhotos&type=Date)](https://star-history.com/#Zeyi-Lin/HivisionIDPhotos&Date)